<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Sharepoint Module - Adding Related Topic Name fields programmatically</title>
    <meta name="description" content="Experts in Linked and Open Data Publishing">
	
	<!-- Twitter Summary Card  -->
	
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@nwplanet" />
	<meta name="twitter:title" content="Sharepoint Module - Adding Related Topic Name fields programmatically" />
	<meta name="twitter:description" content="<p>Related Topic Name and Related Topic Link Fields are custom fields which you may want to add to the site columns collection programmatically. However SharePoint sometimes returns exceptions when trying to use SPFieldCollection.CreateNewField(), the code below shows how to use an feature receiver to create the custom fields programmatically and add them to the site columns.</p>

" />
	<meta nane="twitter:image" content="http://networkedplanet.com/assets/images/np-220px.png" />
	<!-- OpenGraph summary -->
	<meta name="og:title" content="Sharepoint Module - Adding Related Topic Name fields programmatically" />
	<meta name="og:description" content="<p>Related Topic Name and Related Topic Link Fields are custom fields which you may want to add to the site columns collection programmatically. However SharePoint sometimes returns exceptions when trying to use SPFieldCollection.CreateNewField(), the code below shows how to use an feature receiver to create the custom fields programmatically and add them to the site columns.</p>

" />
	<meta name="og:image" content="http://networkedplanet.com/assets/images/np-220px.png" />
	

    <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://networkedplanet.com/feed/" />
    <link rel="alternate" type="application/rss+xml" title="NetworkedPlanet &raquo; Feed" href="http://networkedplanet.com/feed/" />

    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/cookiecuttr.css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <link rel="canonical" href="http://networkedplanet.com/blog/2009/07/02/sharepoint-module-adding-related-topic-name-fields-programmatically.html">
    
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
	<div class="navbar-header">
	  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
		<span class="sr-only">Toggle navigation</span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
	  </button>
	  <a class="navbar-brand page-scroll" href="/#page-top"><img src="/assets/images/np_header.png" alt="NetworkedPlanet"/></a>
	</div>
	<div id="navbar" class="navbar-collapse collapse">
	  <ul class="nav navbar-nav">
		<li class="hidden">
			<a class="page-scroll" href="#page-top"></a>
		</li>
		<li>
			<a class="page-scroll" href="/#products">Products</a>
		</li>
		<li>
			<a class="page-scroll" href="/#services">Services</a>
		</li>
		<li>
			<a class="page-scroll" href="/#training">Training</a>
		</li>
		<li>
			<a class="page-scroll" href="/#contact">Contact Us</a>
		</li>
		<li>
			<a href="/blog/">Blog</a>
		</li>
	  </ul>
	</div>
  </div>
</nav>


    <div class="container">
        <div class="post">

	<div class="spacer-top"></div>
	


<div class="container">

<ol class="breadcrumb">
 
  <li><a href="/">Home</a></li>

  
   
   

   <li><a href="/blog/">Blog</a></li>

   
  
 
 <li>Sharepoint Module - Adding Related Topic Name fields programmatically</li>
</ol>
</div>
	
  <header class="post-header">
    <h1 class="post-title">Sharepoint Module - Adding Related Topic Name fields programmatically</h1>
    <p class="post-meta">Jul 2, 2009 • jen</p>
  </header>

  <article class="post-content">
	
    <p>Related Topic Name and Related Topic Link Fields are custom fields which you may want to add to the site columns collection programmatically. However SharePoint sometimes returns exceptions when trying to use SPFieldCollection.CreateNewField(), the code below shows how to use an feature receiver to create the custom fields programmatically and add them to the site columns.</p>

<p>public override void FeatureActivated(SPFeatureReceiverProperties properties)</p>

<p>{</p>

<p>try</p>

<p>{</p>

<p>var site = properties.Feature.Parent as SPSite;</p>

<p>if (site != null)</p>

<p>{</p>

<p>SPWeb web = site.RootWeb;</p>

<p>const string typeName = “RelatedTopicName”; //important - the type name must be correct</p>

<p>const string displayName = “Related Themes”;</p>

<p>const string internalName = “RTN_Related_Themes_001”;</p>

<p>const string relatedTopicFieldSource = “37d6a246-0cd3-449c-8c06-6ccd75bc1c8c”;</p>

<p>const string showDrafts = “true”;</p>

<p>const string showVersionInfo = “false”;</p>

<p>string customisation = String.Format(@”<customization><arrayofproperty><property><name>SourceFieldId</name>&lt;Value xmlns:q1=""http://www.w3.org/2001/XMLSchema"" p4:type=""q1:string"" xmlns:p4=""http://www.w3.org/2001/XMLSchema-instance""&gt;{0}&lt;/Value&gt;</property><property><name>ShowDrafts</name>&lt;Value xmlns:q2=""http://www.w3.org/2001/XMLSchema"" p4:type=""q2:boolean"" xmlns:p4=""http://www.w3.org/2001/XMLSchema-instance""&gt;{1}&lt;/Value&gt;</property><property><name>ShowVersionInformation</name>&lt;Value xmlns:q3=""http://www.w3.org/2001/XMLSchema"" p4:type=""q3:boolean"" xmlns:p4=""http://www.w3.org/2001/XMLSchema-instance""&gt;{2}&lt;/Value&gt;</property></arrayofproperty></customization>”, relatedTopicFieldSource, showDrafts, showVersionInfo);</p>

<p>string fldxml = String.Format(@”&lt;Field Type=”“{0}”” DisplayName=”“{1}”” Name=”“{2}””&gt;{3}&lt;/Field&gt;”, typeName, displayName, internalName, customisation);</p>

<p>web.Fields.AddFieldAsXml(fldxml);</p>

<p>}</p>

<p>}</p>

<p>catch (Exception e)</p>

<p>{</p>

<p>//Log the error</p>

<p>throw;</p>

<p>}</p>

<p>}</p>


  </article>

  <div class="row spacer2">&nbsp;</div>
  
  <hr/>
  <nav>
    <p>Filed under:  <a href="/blog/tags/tip/">tip</a></p>
    <p class="clearfix">
        
            <span class="pull-left">
                <a class="btn btn-primary" href="/blog/2009/06/29/a-small-useful-ontology-and-what-it-tells-us-about-web3.html" role="previous">&lt;&lt; A small useful ontology and what it tells us about Web3</a>
            </span>
        
        
        <span class="pull-right">
            <a class="btn btn-primary" href="/blog/2009/07/03/subj3ct-com-beta-2-released.html" role="next">Subj3ct.com Beta 2 Released &gt;&gt;</a>
        </span>
        
    </p>
  </nav>
  <hr/>
  
</div>
<div class="spacer2">&nbsp;</div>

    </div>

    <footer class="footer">
    <div class="container">
        <div class="spacer">&nbsp;</div>
        <div class="row">
            <div class="col-xs-6">
                <p>&copy; 2016 Networked Planet Limited.</p>
            </div>
            <div class="col-xs-6">
                <div class="pull-right">
                    <a href="#">Back to top</a>
                </div>
            </div>
        </div> <!-- /.row -->
        <div class="row">
            <div class="col-xs-12">
                <small class="text-muted">Registered in England no. 5273377 Registered Office: 17 Cosgrove Road, Old Stratford, Milton Keynes, MK19 6AG</small>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<!-- Bootstrap plugins -->
<script src="/assets/javascripts/bootstrap.min.js"></script>
<script src="/assets/javascripts/scrolling-nav.js"></script>
<script src="/assets/javascripts/jquery.easing.min.js"></script>

<!-- CookieCuttr script -->
<script src="/assets/javascripts/js.cookie-1.5.1.min.js"></script>
<script src="/assets/javascripts/jquery.cookiecuttr.js"></script>
<script>
    $(document).ready(function() {
        $.cookieCuttr({cookieDeclineButton: true});
    });
    
    if (jQuery.cookie('cc_cookie_decline') == "cc_cookie_decline") {
        // do nothing
    } else {
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
		 ga('create', 'UA-770913-1', 'auto', { 'allowLinker': true });
		ga('require', 'linker');
		ga('linker:autoLink', ['testing.networkedplanet.com']);
		ga('linker:autoLink', ['levelup.networkedplanet.com']);
		ga('linker:autoLink', ['support.networkedplanet.com']);
		ga('send', 'pageview');
		
    }
</script>



    </body>

</html>
