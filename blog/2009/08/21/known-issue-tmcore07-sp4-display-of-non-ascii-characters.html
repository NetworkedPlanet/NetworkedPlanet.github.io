<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Known Issue - TMCore07 SP4 - Display of non-ascii characters</title>
    <meta name="description" content="Data integration and metadata management solutions.
">

    <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://networkedplanet.com/feed/" />
    <link rel="alternate" type="application/rss+xml" title="NetworkedPlanet &raquo; Feed" href="http://networkedplanet.com/feed/" />

    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/cookiecuttr.css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <link rel="canonical" href="http://networkedplanet.com/blog/2009/08/21/known-issue-tmcore07-sp4-display-of-non-ascii-characters.html">
    
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
	<div class="navbar-header">
	  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
		<span class="sr-only">Toggle navigation</span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
	  </button>
	  <a class="navbar-brand page-scroll" href="/#page-top"><img src="/assets/images/np_header.png" alt="NetworkedPlanet"/></a>
	</div>
	<div id="navbar" class="navbar-collapse collapse">
	  <ul class="nav navbar-nav">
		<li class="hidden">
			<a class="page-scroll" href="#page-top"></a>
		</li>
		<li>
			<a class="page-scroll" href="/#products">Products</a>
		</li>
		<li>
			<a class="page-scroll" href="/#services">Services</a>
		</li>
		<li>
			<a class="page-scroll" href="/#contact">Contact Us</a>
		</li>
		<li>
			<a href="/blog/">Blog</a>
		</li>
	  </ul>
	</div>
  </div>
</nav>


    <div class="container">
        <div class="post">

	<div class="spacer-top"></div>
	


<div class="container">

<ol class="breadcrumb">
 
  <li><a href="/">Home</a></li>

  
   
   

   <li><a href="/blog/">Blog</a></li>

   
  
 
 <li>Known Issue - TMCore07 SP4 - Display of non-ascii characters</li>
</ol>
</div>
	
  <header class="post-header">
    <h1 class="post-title">Known Issue - TMCore07 SP4 - Display of non-ascii characters</h1>
    <p class="post-meta">Aug 21, 2009 â€¢ kal</p>
  </header>

  <article class="post-content">
    <p><b>Description</b></p>

<p>TMCore07 SP4 included a fix for the tm_displayName function in the TMCore database that provides the default display name for a topic. Prior to SP4, this function returned a varchar result which meant that non-ASCII characters would display as a ?. From SP4 the function was updated to return an nvarchar result, allowing any Unicode characters to be correctly displayed. Unfortunately the early release of the SP4 package did not include this updated function in the database upgrade script.</p>

<p><b>Systems Affected</b></p>

<p>This problem will show up only on databases that have been upgraded from a previous version of TMCore - clean database installations are not affected by this problem. In addition, the TMCore07 SP4 installer has been fixed so that downloads of the installer taken on or after the 21st August 2009 do not exhibit this problem either for new databases or for upgraded databases.</p>

<p><b>Fix</b></p>

<p>If you downloaded TMCore07 SP4 prior to 21st August 2009, you can apply the update  for the tm_displayName function by running the following SQL script against the TMCore database:</p>

<pre>

-------------------------------------------------------------------

-- tm_displayName

-- Returns a display string for a topic selected from the topics variant names and topic names.

-- Since: 1.0

-- Last Updated: 2.4

if exists (select * from sysobjects

where id = object_id(N'[tm_displayName]') and

xtype in(N'FN',N'IF',N'TF'))

DROP FUNCTION [tm_displayName]

go

CREATE FUNCTION dbo.tm_displayName (@topic int)

RETURNS nvarchar(512)  AS

BEGIN

DECLARE @disp int

DECLARE @ret nvarchar(512)

SELECT @disp = (SELECT TOP 1 topic_id from tm_si

WHERE

tm_si.topicmap = (select topicmapref from topic where id = @topic) and

subj_id='http://www.topicmaps.org/xtm/1.0/core.xtm#display')

SET @ret = (SELECT TOP 1 variant_value FROM tm_nameVariantValue JOIN tm_variantScope ON tm_nameVariantValue.variant_id = tm_variantScope.variant_id

WHERE

tm_nameVariantValue.topic_id = @topic AND tm_variantScope.scoping_topic_id = @disp

ORDER BY tm_nameVariantValue.variant_id ASC)

IF (@ret IS NULL)

SET @ret = (SELECT TOP 1 name_value FROM tm_nameValue JOIN tm_nameScope ON tm_nameValue.name_id = tm_nameScope.name_id

WHERE

tm_nameValue.topic_id = @topic AND tm_nameScope.scoping_topic_id = @disp

ORDER BY tm_nameValue.name_id ASC)

IF (@ret IS NULL)

SET @ret = (SELECT TOP 1 name_value FROM tm_nameValue JOIN tm_nameScope ON tm_nameValue.name_id = tm_nameScope.name_id

WHERE

tm_nameValue.topic_id = @topic and ((tm_nameScope.scoping_topic_id IS NULL)  or (tm_nameScope.scoping_topic_id = -1))

ORDER BY tm_nameVALUE.name_id ASC)

IF (@ret IS NULL)

SET @ret = (SELECT TOP 1 name_value FROM tm_nameValue WHERE tm_nameValue.topic_id = @topic ORDER BY tm_nameValue.name_id)

RETURN @ret

END

GO

grant exec on tm_displayName to tm_reader, tm_writer

go

</pre>


  </article>

  <div class="row spacer2">&nbsp;</div>
  
  <hr/>
  <nav>
    <p>Filed under:  <a href="/blog/tags/tmcore/">tmcore</a></p>
    <p class="clearfix">
        
            <span class="pull-left">
                <a class="btn btn-primary" href="/blog/2009/07/31/tmcore07-sp4-released.html" role="previous">&lt;&lt; TMCore07 SP4 Released</a>
            </span>
        
        
        <span class="pull-right">
            <a class="btn btn-primary" href="/blog/2009/09/14/sharepoint-module-3-1-hotfix-3-now-available.html" role="next">SharePoint Module 3.1 Hotfix 3 now available &gt;&gt;</a>
        </span>
        
    </p>
  </nav>
  <hr/>
  
</div>
<div class="spacer2">&nbsp;</div>

    </div>

    <footer class="footer">
    <div class="container">
        <div class="spacer">&nbsp;</div>
        <div class="row">
            <div class="col-xs-6">
                <p>&copy; 2015 Networked Planet Limited.</p>
            </div>
            <div class="col-xs-6">
                <div class="pull-right">
                    <a href="#">Back to top</a>
                </div>
            </div>
        </div> <!-- /.row -->
        <div class="row">
            <div class="col-xs-12">
                <small class="text-muted">Registered in England no. 5273377 Registered Office: 17 Cosgrove Road, Old Stratford, Milton Keynes, MK19 6AG</small>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<!-- Bootstrap plugins -->
<script src="/assets/javascripts/bootstrap.min.js"></script>
<script src="/assets/javascripts/scrolling-nav.js"></script>
<script src="/assets/javascripts/jquery.easing.min.js"></script>

<!-- CookieCuttr script -->
<script src="/assets/javascripts/js.cookie-1.5.1.min.js"></script>
<script src="/assets/javascripts/jquery.cookiecuttr.js"></script>
<script>
    $(document).ready(function() {
        $.cookieCuttr({cookieDeclineButton: true});
    });
    
    if (jQuery.cookie('cc_cookie_decline') == "cc_cookie_decline") {
        // do nothing
    } else {
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-770913-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document. getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    }
</script>



    </body>

</html>
