<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>SharePoint Module User Scraping</title>
    <meta name="description" content="Experts in Linked and Open Data Publishing">
	
	<!-- Twitter Summary Card  -->
	
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@nwplanet" />
	<meta name="twitter:title" content="SharePoint Module User Scraping" />
	<meta name="twitter:description" content="<p>Over the last couple of weeks I’ve had a lot of queries from developers about the “scraping” that we do to create topics for users in a SharePoint Module topic map. Some confusion has been caused by the fact that we have two ways of doing this and also some concern has been expressed about the amount of logging activity generated in particular by the AddSiteUsers task. This post is a copy of a support response I wrote for the last developer to enquire and I’m posting it here in the hope that it might be useful to others too.</p>

" />
	
	<!-- OpenGraph summary -->
	<meta name="og:title" content="SharePoint Module User Scraping" />
	<meta name="og:description" content="<p>Over the last couple of weeks I’ve had a lot of queries from developers about the “scraping” that we do to create topics for users in a SharePoint Module topic map. Some confusion has been caused by the fact that we have two ways of doing this and also some concern has been expressed about the amount of logging activity generated in particular by the AddSiteUsers task. This post is a copy of a support response I wrote for the last developer to enquire and I’m posting it here in the hope that it might be useful to others too.</p>

" />
	

    <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://networkedplanet.com/feed/" />
    <link rel="alternate" type="application/rss+xml" title="NetworkedPlanet &raquo; Feed" href="http://networkedplanet.com/feed/" />

    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/cookiecuttr.css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <link rel="canonical" href="http://networkedplanet.com/blog/2009/01/14/sharepoint-module-user-scraping.html">
    
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
	<div class="navbar-header">
	  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
		<span class="sr-only">Toggle navigation</span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
	  </button>
	  <a class="navbar-brand page-scroll" href="/#page-top"><img src="/assets/images/np_header.png" alt="NetworkedPlanet"/></a>
	</div>
	<div id="navbar" class="navbar-collapse collapse">
	  <ul class="nav navbar-nav">
		<li class="hidden">
			<a class="page-scroll" href="#page-top"></a>
		</li>
		<li>
			<a class="page-scroll" href="/#products">Products</a>
		</li>
		<li>
			<a class="page-scroll" href="/#services">Services</a>
		</li>
		<li>
			<a class="page-scroll" href="/#training">Training</a>
		</li>
		<li>
			<a class="page-scroll" href="/#contact">Contact Us</a>
		</li>
		<li>
			<a href="/blog/">Blog</a>
		</li>
	  </ul>
	</div>
  </div>
</nav>


    <div class="container">
        <div class="post">

	<div class="spacer-top"></div>
	


<div class="container">

<ol class="breadcrumb">
 
  <li><a href="/">Home</a></li>

  
   
   

   <li><a href="/blog/">Blog</a></li>

   
  
 
 <li>SharePoint Module User Scraping</li>
</ol>
</div>
	
  <header class="post-header">
    <h1 class="post-title">SharePoint Module User Scraping</h1>
    <p class="post-meta">Jan 14, 2009 • kal</p>
  </header>

  <article class="post-content">
	
    <p>Over the last couple of weeks I’ve had a lot of queries from developers about the “scraping” that we do to create topics for users in a SharePoint Module topic map. Some confusion has been caused by the fact that we have two ways of doing this and also some concern has been expressed about the amount of logging activity generated in particular by the AddSiteUsers task. This post is a copy of a support response I wrote for the last developer to enquire and I’m posting it here in the hope that it might be useful to others too.</p>

<p>We have two ways of scraping users from SharePoint into the topic map. There is a Topic Map Timer Task called AddSiteUsers, and a feature called NPProfileScraper.</p>

<p>The AddSiteUsers timer task is activated once on each site (SPWeb) where you activate the NPClassification feature. Its job is to ensure that there is a topic for each user that has access to the site, so when it wakes up it checks the SPWeb.AllUsers property and goes through it checking that each user has a topic in the topic map and creating a new user topic if needed. This task is run by the Topic Map Timer Job which you can see when you look at the farm timer jobs in the SharePoint Central Administration app. The Topic Map Timer Job wakes periodically and looks for Topic Map Timer Task topics in the topic map and then runs them one by one.</p>

<p>The NPProfileScraper feature does something similar but instead of using the SPWeb.AllUsers property on each SPWeb, it communicates with the MOSS Profile Service - this is why it is a separate feature (because you cannot install it on WSS 3.0).</p>

<p>In 3.0 and the current 3.1 beta, NPProfileScraper is much more configurable than AddSiteUsers. For example you can set NPProfileScraper to run once every X hours (default is 24) and you can specify the type to assign to the new user topics. AddSiteUsers tasks just run as frequently as the Time Job and because you have one per SPWeb that can be a lot of activity. Currently the only way to stop AddSiteUsers tasks from running is to go into the topic map (the default one you have named in NPSharePoint.xml) and delete all topics that have the name “AddSiteUsers - xxx” where xxx is a site name. Its not pretty but it does work, until someone activates NPClassification again, when the task topic gets created and the whole thing starts again.</p>

<p>In 3.1 we have fixed this by allowing you to configure AddSiteUsers to also run once every X hours (per SPWeb) and to also configure AddSiteUsers to never run.</p>

<p>The logging is another issue. In 3.0 and the early 3.1 betas there was no support for throttling logging like you can with the standard SharePoint logging (e.g. restrict it to logging only Error level messages and above). In the 3.1 release this will be fixed and you will be able to use the SharePoint Central Administration site to set the throttling for a number of different SharePoint Module-specific log categories.</p>

<p>If you are working on a 3.1 beta AND you have your users in the MOSS Profile Service (so NPProfileScraper gets them), then my advice is that you delete all the AddSiteUsers topics from the topic map now and when you get the final 3.1 release make sure that you set the configuration in NPSharePoint.xml to never allow those tasks to run.</p>

<p>If you are working on 3.0 and need a better fix than the workaround described above, please let me know and I’ll try and get a new Hotfix out that includes some of the changes we already made in the main development branch of the code.</p>


  </article>

  <div class="row spacer2">&nbsp;</div>
  
  <hr/>
  <nav>
    <p>Filed under:  <a href="/blog/tags/tip/">tip</a></p>
    <p class="clearfix">
        
            <span class="pull-left">
                <a class="btn btn-primary" href="/blog/2009/01/12/sharepoint-module-hotfix-9-now-available.html" role="previous">&lt;&lt; SharePoint Module Hotfix 9 Now Available</a>
            </span>
        
        
        <span class="pull-right">
            <a class="btn btn-primary" href="/blog/2009/01/29/sharepoint-module-known-issue-topics-not-created-for-pages.html" role="next">SharePoint Module Known Issue - Topics not created for Pages &gt;&gt;</a>
        </span>
        
    </p>
  </nav>
  <hr/>
  
</div>
<div class="spacer2">&nbsp;</div>

    </div>

    <footer class="footer">
    <div class="container">
        <div class="spacer">&nbsp;</div>
        <div class="row">
            <div class="col-xs-6">
                <p>&copy; 2016 Networked Planet Limited.</p>
            </div>
            <div class="col-xs-6">
                <div class="pull-right">
                    <a href="#">Back to top</a>
                </div>
            </div>
        </div> <!-- /.row -->
        <div class="row">
            <div class="col-xs-12">
                <small class="text-muted">Registered in England no. 5273377 Registered Office: 17 Cosgrove Road, Old Stratford, Milton Keynes, MK19 6AG</small>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<!-- Bootstrap plugins -->
<script src="/assets/javascripts/bootstrap.min.js"></script>
<script src="/assets/javascripts/scrolling-nav.js"></script>
<script src="/assets/javascripts/jquery.easing.min.js"></script>

<!-- CookieCuttr script -->
<script src="/assets/javascripts/js.cookie-1.5.1.min.js"></script>
<script src="/assets/javascripts/jquery.cookiecuttr.js"></script>
<script>
    $(document).ready(function() {
        $.cookieCuttr({cookieDeclineButton: true});
    });
    
    if (jQuery.cookie('cc_cookie_decline') == "cc_cookie_decline") {
        // do nothing
    } else {
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
		 ga('create', 'UA-770913-1', 'auto', { 'allowLinker': true });
		ga('require', 'linker');
		ga('linker:autoLink', ['testing.networkedplanet.com']);
		ga('linker:autoLink', ['levelup.networkedplanet.com']);
		ga('linker:autoLink', ['support.networkedplanet.com']);
		ga('send', 'pageview');
		
    }
</script>



    </body>

</html>
