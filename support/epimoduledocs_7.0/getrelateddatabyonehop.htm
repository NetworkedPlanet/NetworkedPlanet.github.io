<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>GetRelatedDataByOneHop</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?getrelateddatabyonehop.htm"; }
  else { parent.quicksync('a5.3.1.1.2'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">GetRelatedDataByOneHop</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="introduction.htm">Top</a>&nbsp;
     <a href="getrelatedpagesbyonehop.htm">Previous</a>&nbsp;
     <a href="two_hop_queries.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>This method returns a <span class="f_InlineCode">DataSet</span> instance containing the topic ID of the page topics found, EPiServer page ID of pages found, and whether the association linking to this page was deleted or published. This data set can easily be bound to the templated data bound controls provided in ASP.NET such as <span class="f_InlineCode">Repeater</span>, <span class="f_InlineCode">DataList</span> and <span class="f_InlineCode">DataGrid</span>.</p>
<p>The <span class="f_InlineCode">DataSet</span> returned by the method contains a single DataTable with the following columns:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 14px 0px 10px 1px;"><table cellspacing="0" cellpadding="3" border="1" style="border: solid 2px #000000; border-spacing:0px; border-collapse: collapse;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;">Column Name</p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;">Description</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span class="f_InlineCode">topicid</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;">The TMCore ID of the page topic found by traversing the association.</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span class="f_InlineCode">pageid</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;">The EPiServer Page ID of the page found by traversing the association.</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span class="f_InlineCode">assocIsPublished</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;">Set to <span class="f_InlineCode">true</span> if the association traversed is published</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span class="f_InlineCode">assocIsDeleted</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;">Set to <span class="f_InlineCode">true</span> if the association traversed is marked as deleted</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span class="f_InlineCode">pageLinkURL</span> <span style="font-style: italic;">(optional)</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;">The URL of the page found by traversing the association.</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span class="f_InlineCode">pageName</span> <span style="font-style: italic;">(optional)</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;">The name of the page found by traversing the association.</p>
</td>
</tr>
</table>
</div>
<p>The method itself has two forms:</p>
<p class="p_CodeExample"><span class="f_CodeExample">public&nbsp;DataSet&nbsp;GetRelatedDataByOneHop(</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">PageData&nbsp;page,</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">string&nbsp;assoctype,</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">string&nbsp;targroletype</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">)</span></p>
<p>and</p>
<p class="p_CodeExample"><span class="f_CodeExample">public&nbsp;DataSet&nbsp;GetRelatedDataByOneHop(</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">PageData&nbsp;page,</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">string&nbsp;assoctype,</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">string&nbsp;targroletype,</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">bool&nbsp;addPageLinkAndName</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">)</span></p>
<p>&nbsp;</p>
<p>The <span class="f_InlineCode">page</span> parameter is the EPiServer <span class="f_InlineCode">PageData</span> for the page from which the one-hop traversal will start. This can typically be retrieved from within a Page Template as the CurrentPage value. The <span class="f_InlineCode">assoctype</span> parameter is the subject identifier of the association type to traverse and the <span class="f_InlineCode">targetroletype</span> parameter is the subject identifier of the role type of the role played by the topic at the other end of the traversal. The optional <span class="f_InlineCode">pageLinkURL</span> and <span class="f_InlineCode">pageName</span> columns are included only if the boolean <span class="f_InlineCode">addPageLinkAndName</span> parameter of the second form of method call is set to true. The code snippet below shows a fragment of the code-behind for a Page Template that is using the GetRelatedDataByOneHop method to generate a list of related page links.</p>
<p class="p_CodeExample"><span class="f_CodeExample">DataSet&nbsp;resultsSet&nbsp;=&nbsp;helper.GetRelatedDataByOneHop(</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;this.CurrentPage,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Current&nbsp;page&nbsp;represents&nbsp;a&nbsp;person</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;"http://psi.networkedplanet.com/associations/departmenthasmember",&nbsp;//&nbsp;Association&nbsp;type</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;"http://psi.networkedplanet.com/roletypes/department",&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Find&nbsp;all&nbsp;the&nbsp;pages&nbsp;playing&nbsp;the&nbsp;role&nbsp;of&nbsp;department</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;true);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Include&nbsp;page&nbsp;link&nbsp;and&nbsp;name</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">if&nbsp;(resultsSet.Tables.Count&nbsp;&gt;&nbsp;0)&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;//&nbsp;Bind&nbsp;a&nbsp;repeater&nbsp;on&nbsp;the&nbsp;page&nbsp;to&nbsp;the&nbsp;results&nbsp;table</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;DepartmentsRepeater.DataSource&nbsp;=&nbsp;resultsSet.Tables[0];&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;DepartmentsRepeater.DataBind();</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p>And in the page template ASPX the repeater code might look like this:</p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;asp:Repeater&nbsp;runat="server"&nbsp;ID="DepartmentsRepeater"&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&lt;HeaderTemplate&gt;&lt;ul&gt;&lt;/HeaderTemplate&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&lt;FooterTemplate&gt;&lt;/ul&gt;&lt;/FooterTemplate&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&lt;ItemTemplate&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;href="&lt;%#&nbsp;DataBinder.Eval(Container.DataItem,&nbsp;"pageLinkURL")&nbsp;%&gt;"&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;%#&nbsp;DataBinder.Eval(Container.DataItem,&nbsp;"pageName")&nbsp;%&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/a&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&lt;/ItemTemplate&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;/asp:Repeater&gt;</span></p>

</td></tr></table>

</body>
</html>
