<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>Mapping Page Properties to Occurrences</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?ar01s02s03.htm"; }
  else { parent.quicksync('a4.1.3'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Mapping Page Properties to Occurrences</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="introduction.htm">Top</a>&nbsp;
     <a href="ar01s02s02.htm">Previous</a>&nbsp;
     <a href="ar01s02s04.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p>The TMCore EPiServer Module also allows the administrator to map page properties to occurrence values, so that when an editor updates a property on the page an occurrence is created on the topic for the page containing either the value of the page property, or a derivation of it.</p>
<p>The mappings are specified in the <span class="f_InlineCode">web.config</span> file using a new configuration section. At the top of the <span class="f_InlineCode">web.config</span> file declare the following configuration section:</p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;sectionGroup&nbsp;name="TMCoreEPiServerModule"&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&lt;section&nbsp;name="OccurrenceMappings"&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allowLocation="false"&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type="NetworkedPlanet.EPiServerModule.FieldMapper.ConfigurationSectionHandler,&nbsp;NetworkedPlanet.EPiServerModule,&nbsp;Culture=neutral,&nbsp;PublicKeyToken=da294bc4e1ae447d"/&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;/sectionGroup&gt;</span></p>
<p>Then as a direct child of the <span class="f_InlineCode">&lt;configuration&gt;</span> top-level element add the following:</p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;TMCoreEPiServerModule&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&lt;OccurrenceMappings&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&lt;/OccurrenceMappings&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;/TMCoreEPiServerModule&gt;</span></p>
<p>Within the <span class="f_InlineCode">&lt;OccurrenceMappings&gt;</span> element you may define individual mappings in the following format:</p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;mapping</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;pageTypeName="epiPageTypeName"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;pageFieldName="epiPropertyName"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;occurrenceTypeSI="subjectIdentifier"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;occurrenceData="resource|value"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;addOnPublish="true|false"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;serializerType="typeName"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">/&gt;</span></p>
<p><span class="f_InlineCode">&lt;mapping&gt;</span> elements may not be nested. The attributes are interpreted as follows:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 14px 0px 10px 1px;"><table cellspacing="0" cellpadding="3" border="1" style="border: solid 2px #000000; border-spacing:0px; border-collapse: collapse;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span style="font-style: italic;">Attribute Name</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span style="font-style: italic;">Attribute Description</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span style="font-style: italic;">Required/Default</span></p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p style="margin: 0px 0px 0px 0px;"><span style="font-style: italic;">Example values</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p>pageTypeName</p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p>Specifies the name of the an EPiServer Page Type. This mapping will apply only to this page type.</p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p>This value is required, there is no default. If not specified, or invalid then this mapping will be ignored.</p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p>Person</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top" style="border: solid 1px #000000;"><p>pagePropertyName</p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p>Specifies the name of the page property that will be stored in the occurrence.</p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p>This value is required, there is no default. If not specified, or invalid then this mapping will be ignored.</p>
</td>
<td valign="top" style="border: solid 1px #000000;"><p>Photo</p>
<p>Age</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="middle" style="border: solid 1px #000000;"><p>occurrenceTypeSI</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>The subject identifier of an existing occurrence type that will be used to type the occurrence created for this mapping.</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>This value is required, there is no default. If not specified, or invalid then this mapping will be ignored.</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>http://psi.networkedplanet.com/occType/Photo</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="middle" style="border: solid 1px #000000;"><p>occurrenceData</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>Specifies whether the occurrence data stored should be stored as a value or a resource (URI). To specify a resource set this to the word resource (case insensitive), for all other values a value occurrence is created.</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>This value is not required, the default behaviour is to store the property data as a value occurrence.</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>resource</p>
<p>value</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="middle" style="border: solid 1px #000000;"><p>addOnPublish</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>Specifies when the occurrence value is to be updated. If true (case insensitive) then the occurrence will only be update at the point of publication. Otherwise, the occurrence will be created as soon a a value is present for the property, and will be updated whenever an editor updates the page.</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>This value is not required, the default behaviour is to update the occurrence whenever the page is saved.</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>true</p>
<p>false</p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="middle" style="border: solid 1px #000000;"><p>serializerType</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>Specifies a fully qualified type name that will be used to serialize the value to the occurrence. This is useful when some processing or formatting needs to be. Instances of the type specified must implement the <span class="f_InlineCode">NetworkedPlanet.EPiServerModule.FieldMapper.IOccurrenceValueSerializer</span> interface.</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>This value is not required, the default behaviour is to serialize the result of calling on the property value: <span class="f_InlineCode">PropertyData.Value.ToString()</span>. If this results in the empty string, or null, then the occurrence is not created.</p>
</td>
<td valign="middle" style="border: solid 1px #000000;"><p>NetworkedPlanet.EPiServerModule.FieldMapper.DefaultSerializer,NetworkedPlanet.EPiServerModule,Culture=Neutral,PublicKeyToken=da294bc4e1ae447d</p>
</td>
</tr>
</table>
</div>
<p class="p_TableCaption"><span class="f_TableCaption">Attributes of the mapping element for defining occurrence mappings</span></p>
<p class="p_Notes"><span class="f_Notes">If an invalid mapping is detected, then an error message will be printed out in the EPiServer log. No other cues are given to the administrator that a mapping has failed (i.e. if a mapping fails then EPiServer will continue to function normally).</span></p>
<p class="p_Heading1"><span class="f_Heading1">Example Mappings</span></p>
<p>The following is a very simple mapping that makes use of all the defaults to create a value occurrence for the value of the <span class="f_InlineCode">name</span> property on any instance of page <span class="f_InlineCode">Person</span>.</p>
<p class="p_CodeExample"><span style="font-size: 10pt; font-family: 'Courier New';">&nbsp;</span><span class="f_CodeExample">&lt;mapping</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;pageTypeName="Person"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;pageFieldName="name"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;occurrenceTypeSI="http://psi.networkedplanet.com/occurrences/name"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;/&gt;</span></p>
<p>The following mapping shows how you can use a custom serializer to process an occurrence value. This serialize takes a date of birth field for a person and stores in the topic map the name of the season that user was born. The code for the serializer is shown below:</p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&lt;mapping</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;pageTypeName="Person"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;pageFieldName="dateofbirth"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;occurrenceTypeSI="http://psi.networkedplanet.com/occurrences/seasonBorn"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;addOnPublish="false"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;serializerType="NetworkedPlanet.EPiServerModule.FieldMapper.SeasonBornSerializer,NetworkedPlanet.EPiServerModule,&nbsp;Culture=Neutral,&nbsp;PublicKeyToken=da294bc4e1ae447d"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;/&gt;</span></p>
<p>&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExample">using&nbsp;System;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">using&nbsp;EPiServer.Core;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">namespace&nbsp;NetworkedPlanet.EPiServerModule.FieldMapper</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;&lt;summary&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;Converts&nbsp;the&nbsp;&lt;see&nbsp;cref="DateTime"/&gt;&nbsp;property&nbsp;passed&nbsp;to&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;season.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;&lt;/summary&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;class&nbsp;SeasonBornSerializer&nbsp;:&nbsp;IOccurrenceValueSerializer</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;&lt;summary&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;Serializes&nbsp;a&nbsp;property&nbsp;value&nbsp;to&nbsp;be&nbsp;serialized&nbsp;to&nbsp;a&nbsp;string&nbsp;in&nbsp;the&nbsp;form&nbsp;of&nbsp;an&nbsp;occurrence.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;&lt;/summary&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;&lt;param&nbsp;name="page"&gt;The&nbsp;page&nbsp;containing&nbsp;the&nbsp;property.&nbsp;&nbsp;This&nbsp;is&nbsp;included&nbsp;in&nbsp;case&nbsp;the&nbsp;occurrence&nbsp;value&nbsp;needs&nbsp;derivation&nbsp;from&nbsp;other&nbsp;page&nbsp;properties.&lt;/param&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;&lt;param&nbsp;name="property"&gt;The&nbsp;property&nbsp;that&nbsp;is&nbsp;being&nbsp;serialized.&lt;/param&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;&lt;returns&gt;A&nbsp;string&nbsp;value&nbsp;that&nbsp;will&nbsp;be&nbsp;placed&nbsp;in&nbsp;to&nbsp;the&nbsp;occurrence.&lt;/returns&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;string&nbsp;Serialize(PageData&nbsp;page,&nbsp;PropertyData&nbsp;property)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;season&nbsp;=&nbsp;String.Empty;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(property.Value!=null)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DateTime&nbsp;dt&nbsp;=&nbsp;(DateTime)&nbsp;property.Value;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch(dt.Month)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;12:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;1:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;2:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;season&nbsp;=&nbsp;"Winter";</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;3:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;4:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;5:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;season&nbsp;=&nbsp;"Spring";</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;6:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;7:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;8:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;season&nbsp;=&nbsp;"Summer";</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;9:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;10:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;11:</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;season&nbsp;=&nbsp;"Autumn&nbsp;(Fall)";</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;season;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">}</span></p>
<p style="margin: 14px 0px 10px 0px;">As you can see from the code, if the value for the month cannot be parsed (for example, because no date has been specified), then the empty string is returned, which is equivalent to returning null, which instructs the TMCore EPiServer Module to not create an occurrence (or remove an existing one).</p>
<p class="p_Heading1"><span class="f_Heading1">Restrictions &amp; Caveats</span></p>
<p class="p_Warning"><span class="f_Warning">DO NOT use different values for </span><span class="f_InlineCode">addOnPublish</span><span class="f_Warning"> when using the same occurrence type and same page type.</span></p>
<p>An example of this would be:</p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;mapping</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;pageTypeName="Person"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;pageFieldName="firstName"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;occurrenceTypeSI="http://psi.networkedplanet.com/occurrences/name"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;addOnPublish="false"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;/&gt;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&lt;mapping</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;pageTypeName="Person"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;pageFieldName="secondName"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;occurrenceTypeSI="http://psi.networkedplanet.com/occurrences/name"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;addOnPublish="true"</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;/&gt;</span></p>
<p>Here, the mapping is trying to instruct the TMCore EPiServer Module to update the occurrence for someone's first name whenever the page is saved, but only update their last name when the page is published. This will not work and you will observe the following effect:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="18"><span style="font-size: 12pt; font-family: 'Times New Roman'; color: #000000;">1.</span></td><td>When the page is saved, things appear to work; the <span class="f_InlineCode">firstName</span> occurrence will appear in the topic map.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="18"><span style="font-size: 12pt; font-family: 'Times New Roman'; color: #000000;">2.</span></td><td>When the page is published, things still appear to work, the <span class="f_InlineCode">secondName</span> occurrence will appear in the topic map.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="18"><span style="font-size: 12pt; font-family: 'Times New Roman'; color: #000000;">3.</span></td><td>When the <span class="f_InlineCode">firstName</span> is changed this is where things break. Instead of updating the old occurrence value, a new occurrence will be created each time the property is updated.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="18"><span style="font-size: 12pt; font-family: 'Times New Roman'; color: #000000;">4.</span></td><td>When the page is published all occurrences are reset and things will be back to normal.</td></tr></table></div><p>This happens because the TMCore EPiServer Module can't tell whether an occurrence on the topic is meant to be there or not. When the page is saved the TMCore EPiServer Module needs a way to ignore occurrences that are only meant to be updated on publish (i.e. not update them). When a page property is updated the old value of the property is not available, therefore it is not possible to find the occurrence that was created for the old values - &nbsp;the best we can do if look for an occurrence of the correct type. If the occurrence created with addOnPublish=false has the same type as the occurrence created with addOnPublish=true the TMCore EPiServer Module cannot determine whether an existing occurrence is the old value of the "secondName" property or if it is an old value of the "firstName" property that should be overwritten.</p>
<p>To work around this either:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="18"><span style="font-size: 12pt; font-family: 'Times New Roman'; color: #000000;">1.</span></td><td>Use a different occurrence type for the mappings or</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="18"><span style="font-size: 12pt; font-family: 'Times New Roman'; color: #000000;">2.</span></td><td>Set the occurrence types to both update on edit or update on publish.</td></tr></table></div>
</td></tr></table>

</body>
</html>
